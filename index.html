<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Locate, Assign, Refine: Taming Customized Image Inpainting with Text-Subject Guidance</title>
    <link href="./public/style.css" rel="stylesheet">
  </head>

  <body>
      <div class="content">
        <h1><strong>
          Locate, Assign, Refine: Taming Customized Image Inpainting with Text-Subject Guidance
        </strong></h1>
        <p id="authors">
          <span><a href=""></a></span>
          <a href="" style="pointer-events: none; text-decoration:none; color: black;">Yulin Pan</a><sup style="margin-left: -7px;">1</sup>
          <a href="" style="pointer-events: none; text-decoration:none; color: black;">Chaojie Mao</a><sup style="margin-left: -7px;">1</sup>
          <a href="" style="pointer-events: none; text-decoration:none; color: black;">Zeyinzi Jiang</a><sup style="margin-left: -7px;">1</sup>
          <a href="" style="pointer-events: none; text-decoration:none; color: black;">Zhen Han</a><sup style="margin-left: -7px;">1</sup>
          <a href="" style="pointer-events: none; text-decoration:none; color: black;">Jingfeng Zhang</a><sup style="margin-left: -7px;">1</sup>
          <br><br>
          <span style="font-size: 22px;"><sup>1</sup>Alibaba Group</span>
          <!-- <br> -->
          &nbsp;&nbsp;&nbsp;
        </p>
        <br>
        <img src="./public/images/teaser.svg" class="teaser-gif" style="width:100%">
        <br>
        <p style="text-align: center; font-size: 18px;">
          <em>
            LAR-Gen is a unified image inpainting framework that supports <strong>text-guided</strong>, <strong>subject-guided</strong> and <strong>text-subject-guided</strong> inpainting simutaneously.
          </em>
        </p>
        <p style="text-align: center; font-size: 20px;">
          <a href="https://arxiv.org/abs/2302.09778" target="_blank">[Paper]</a>
          &nbsp;&nbsp;&nbsp;
          <a href="./public/bibtex.txt" target="_blank">[BibTeX]</a>
          &nbsp;&nbsp;&nbsp;
          <a href="" target="_blank">[Code]</a>
        </p>
      </div>

      <div class="content">
        <h2 style="text-align: center;">Abstract</h2>
        <p>
          Prior studies have made significant progress in image inpainting guided by either text or subject image.However, the research on editing with their combined guidance is still in the early stages. To tackle this challenge, we present <strong>LAR-Gen</strong>, a novel approach for image inpainting that enables seamless inpainting of masked scene images, incorporating both the textual prompts and specified subjects. Our approach adopts a coarse-to-fine manner to ensure subject identity preservation and local semantic coherence. The process involves (i) <strong>Locate</strong>: concatenating the noise with masked scene image to achieve precise regional editing, (ii) <strong>Assign</strong>: employing decoupled cross-attention mechanism to accommodate multi-modal guidance, and (iii) <strong>Refine</strong>: using a novel RefineNet to supplement subject details. Additionally, to address the issue of scarce training data, we introduce a novel data construction pipeline. This pipeline extracts substantial pairs of data consisting of local text prompts and corresponding visual instances from a vast image dataset, leveraging publicly available large models.Extensive experiments and varied application scenarios demonstrate the superiority of \method in terms of both identity preservation and text semantic consistency.
        </p>
      </div>

      <div class="content">
        <h2>Framework</h2>
        <p style="font-size: 18px">
          The whole framework consists of three key mechanisms: the <em>Locate mechanism</em> concatenates the noise with masked scene image and mask to compel the model to seamlessly inpaint the masked region while keeping the background unaltered; the <em>Assign mechanism</em>, indeed a decoupled cross-attention mechansim, achieves text compatible subject guidance on denoising process; the <em>Refine mechanism</em> utilizes a RefineNet to gradually supplement the subject details, facilitating subject identity preservation. The fire icon indicates that the module parameter requires tuning, while the snow icon signifies that no tuning is needed.
        </p>
        <img class="summary-img" src="./public/images/framework.png" style="width:100%;"><br><br>
      </div>

      <div class="content">
        <h2>Data Construction Strategy</h2>
        <p style="font-size: 18px">
          The pipeline involves a sequence of automated processes including categorization, detection, segmentation, and captioning. As a result, it creates region-level quadruplets that include a scene image, a scene mask, a subject image, and a text prompt.
        </p>
        <img class="summary-img" src="./public/images/data_proc.svg" style="width:100%;"><br><br>
      </div>

      <div class="content">
        <h2>Comparison with other inpainting methods</h2>
        <p style="font-size: 18px">
          Unlike other methods that depend solely on textual or visual prompts, LAR-Gen achieves customized image inpainting by leveraging both the subject image and text prompt.
        </p>
        <img class="summary-img" src="./public/images/sota_comp.svg" style="width:100%;"><br><br>
      </div>

      <div class="content">
        <h2>Ablation Studies</h2>
        <p style="font-size: 18px">
          <strong>Image Strength</strong>
        </p>
        <img class="summary-img" src="./public/images/abl_beta.svg" style="width:100%;">
        <p style="font-size: 18px">
          <strong>Module</strong>
        </p>
        <img class="summary-img" src="./public/images/abl_module.svg" style="width:100%;">
        <p style="font-size: 18px">
          <strong>UNet Backbone</strong>
        </p>
        <p style="font-size: 18px">
          <strong>SD-1.5</strong>
        </p>
        <img class="summary-img" src="./public/images/sd15.svg" style="width:100%;">
        <p style="font-size: 18px">
          <strong>SD-XL</strong>
        </p>
        <img class="summary-img" src="./public/images/sdxl.svg" style="width:100%;"><br><br>
      </div>

      <!-- <div class="content">
        <h2>BibTex</h2>
        <code>
        </code>
      </div> -->

      <br><br>
      <footer class="footer">
        <div class="container">
          <div class="columns is-centered">
            <!-- <div class="content"> -->
              website template from <a href="https://dreambooth.github.io/">dreambooth</a>
            <!-- </div> -->
          </div>
        </div>
      </footer>
      <br><br>
  </body>
</html>
